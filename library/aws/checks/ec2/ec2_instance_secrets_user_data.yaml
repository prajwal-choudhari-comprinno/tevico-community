
Provider: aws
CheckID: ec2_instance_secrets_user_data
CheckTitle: Ensure no secrets are present in EC2 user data.
CheckType:
  - IAM
ServiceName: ec2
SubServiceName: ""
ResourceIdTemplate: arn:partition:access-analyzer:region:account-id:analyzer/resource-id
Severity: critical
ResourceType: AwsEc2Instance
Description: Ensure that no secrets are present in EC2 user data.
Risk: Secrets hardcoded into instance user data can be used by malware and bad actors to gain lateral access to other services.
RelatedUrl: https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-instance-metadata.html
Remediation:
  Code:
    CLI: ""
    NativeIaC: ""
    Other: ""
    Terraform: ""
  Recommendation:
    Text: Implement automated detective control (e.g. using tools like Tevico) to scan accounts for passwords and secrets. Use secrets manager service to store and retrieve passwords and secrets.
    Url: https://docs.aws.amazon.com/secretsmanager/latest/userguide/tutorials_basic.html
Categories:
  - secrets
DependsOn: []
RelatedTo: []
Notes: Infrastructure Protection
